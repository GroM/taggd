!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Taggd=e()}}(function(){return function o(s,a,u){function l(t,e){if(!a[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(p)return p(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=a[t]={exports:{}};s[t][0].call(i.exports,function(e){return l(s[t][1][e]||e)},i,i.exports,o,s,a,u)}return a[t].exports}for(var p="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,n){t.exports=function(e){if(Array.isArray(e))return e}},{}],2:[function(e,t,n){t.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},{}],3:[function(e,t,n){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],4:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}t.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},{}],5:[function(e,r,t){e("./getPrototypeOf");var o=e("./superPropBase");function i(e,t,n){return"undefined"!=typeof Reflect&&Reflect.get?r.exports=i=Reflect.get:r.exports=i=function(e,t,n){var r=o(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}},i(e,t,n||e)}r.exports=i},{"./getPrototypeOf":6,"./superPropBase":14}],6:[function(e,t,n){function r(e){return t.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}t.exports=r},{}],7:[function(e,t,n){var r=e("./setPrototypeOf");t.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},{"./setPrototypeOf":12}],8:[function(e,t,n){t.exports=function(e){return e&&e.__esModule?e:{default:e}}},{}],9:[function(e,t,n){t.exports=function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}},{}],10:[function(e,t,n){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},{}],11:[function(e,t,n){var r=e("../helpers/typeof"),i=e("./assertThisInitialized");t.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},{"../helpers/typeof":15,"./assertThisInitialized":2}],12:[function(e,n,t){function r(e,t){return n.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}n.exports=r},{}],13:[function(e,t,n){var r=e("./arrayWithHoles"),i=e("./iterableToArrayLimit"),o=e("./nonIterableRest");t.exports=function(e,t){return r(e)||i(e,t)||o()}},{"./arrayWithHoles":1,"./iterableToArrayLimit":9,"./nonIterableRest":10}],14:[function(e,t,n){var r=e("./getPrototypeOf");t.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},{"./getPrototypeOf":6}],15:[function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return"function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?t.exports=i=function(e){return r(e)}:t.exports=i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)},i(e)}t.exports=i},{}],16:[function(e,t,n){t.exports=function(e){if(e.getBoundingClientRect)return e.getBoundingClientRect();for(var t=0,n=0;t+=e.offsetLeft-e.scrollLeft,n+=e.offsetTop-e.scrollTop,e=e.offsetParent;);return{left:t,top:n}}},{}],17:[function(e,t,n){t.exports=function(){return window.pageYOffset?window.pageYOffset:document.documentElement.clientHeight?document.documentElement.scrollTop:document.body.scrollTop}},{}],18:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),s=r(e("@babel/runtime/helpers/slicedToArray")),a=r(e("@babel/runtime/helpers/classCallCheck")),i=r(e("@babel/runtime/helpers/createClass")),u=r(e("@babel/runtime/helpers/possibleConstructorReturn")),l=r(e("@babel/runtime/helpers/assertThisInitialized")),p=r(e("@babel/runtime/helpers/getPrototypeOf")),c=r(e("@babel/runtime/helpers/get")),f=r(e("@babel/runtime/helpers/inherits")),o=e("../util/event-emitter"),h=e("../util/object-is"),d=e("../util/type-error-message"),g=function(e){function o(e,t){var n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};if((0,a.default)(this,o),!h.ofType(e,"object")||Array.isArray(e))throw new TypeError(d.getObjectMessage(e));if(!("x"in e&&"y"in e))throw new Error("".concat(e," should have x and y property"));return(n=(0,u.default)(this,(0,p.default)(o).call(this))).wrapperElement=document.createElement("div"),n.wrapperElement.classList.add("taggd__wrapper"),n.buttonElement=document.createElement("button"),n.buttonElement.classList.add("taggd__button"),n.popupElement=document.createElement("span"),n.popupElement.classList.add("taggd__popup"),n.wrapperElement.appendChild(n.buttonElement),n.wrapperElement.appendChild(n.popupElement),n.isControlsEnabled=!1,n.inputLabelElement=void 0,n.buttonSaveElement=void 0,n.buttonDeleteElement=void 0,n.buttonSaveElementClickHandler=function(){return n.setText(n.inputLabelElement.value)},n.buttonDeleteElementClickHandler=function(){n.emit("taggd.tag.delete",(0,l.default)(n))},n.text=void 0,n.setButtonAttributes(r),n.setPopupAttributes(i),n.setPosition(e.x,e.y),n.setText(t),n.hide(),n}return(0,f.default)(o,e),(0,i.default)(o,[{key:"on",value:function(e,t){return(0,c.default)((0,p.default)(o.prototype),"on",this).call(this,e,t)}},{key:"off",value:function(e,t){return(0,c.default)((0,p.default)(o.prototype),"off",this).call(this,e,t)}},{key:"once",value:function(e,t){return(0,c.default)((0,p.default)(o.prototype),"once",this).call(this,e,t)}},{key:"isHidden",value:function(){return"none"===this.popupElement.style.display}},{key:"show",value:function(){return!this.emit("taggd.tag.show",this)||(this.popupElement.style.display="",this.emit("taggd.tag.shown",this)),this}},{key:"hide",value:function(){return!this.emit("taggd.tag.hide",this)||(this.popupElement.style.display="none",this.emit("taggd.tag.hidden",this)),this}},{key:"setText",value:function(e){if(!h.ofType(e,"string")&&!h.function(e))throw new TypeError(d.getMessage(e,"a string or a function"));return!this.emit("taggd.tag.change",this)||(h.function(e)?this.text=e(this):this.text=e,this.isControlsEnabled?this.inputLabelElement.value=this.text:this.popupElement.innerHTML=this.text,this.emit("taggd.tag.changed",this)),this}},{key:"setPosition",value:function(e,t){if(!h.number(e))throw new TypeError(d.getFloatMessage(e));if(!h.number(t))throw new TypeError(d.getFloatMessage(t));if(!!this.emit("taggd.tag.change",this)){var n=o.getPositionStyle(e,t);this.wrapperElement.style.left=n.left,this.wrapperElement.style.top=n.top,this.emit("taggd.tag.changed",this)}return this}},{key:"setButtonAttributes",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};if(!h.ofType(t,"object")||Array.isArray(t))throw new TypeError(d.getObjectMessage(t));return!this.emit("taggd.tag.change",this)||(o.setElementAttributes(this.buttonElement,t),this.emit("taggd.tag.changed",this)),this}},{key:"setPopupAttributes",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};if(!h.ofType(t,"object")||Array.isArray(t))throw new TypeError(d.getObjectMessage(t));return!this.emit("taggd.tag.change",this)||(o.setElementAttributes(this.popupElement,t),this.emit("taggd.tag.changed",this)),this}},{key:"enableControls",value:function(){return this.isControlsEnabled=!0,this.inputLabelElement=document.createElement("input"),this.buttonSaveElement=document.createElement("button"),this.buttonDeleteElement=document.createElement("button"),this.inputLabelElement.classList.add("taggd__editor-input"),this.buttonSaveElement.classList.add("taggd__editor-button","taggd__editor-button--save"),this.buttonDeleteElement.classList.add("taggd__editor-button","taggd__editor-button--delete"),this.buttonSaveElement.innerHTML=o.LABEL_BUTTON_SAVE,this.buttonDeleteElement.innerHTML=o.LABEL_BUTTON_DELETE,this.buttonSaveElement.addEventListener("click",this.buttonSaveElementClickHandler),this.buttonDeleteElement.addEventListener("click",this.buttonDeleteElementClickHandler),this.popupElement.innerHTML="",this.popupElement.appendChild(this.inputLabelElement),this.popupElement.appendChild(this.buttonSaveElement),this.popupElement.appendChild(this.buttonDeleteElement),this.setText(this.text),this}},{key:"disableControls",value:function(){return this.isControlsEnabled=!1,this.inputLabelElement=void 0,this.buttonSaveElement=void 0,this.buttonDeleteElement=void 0,this.setText(this.text),this}},{key:"toJSON",value:function(){function e(e){var t={};return Array.prototype.forEach.call(e,function(e){"class"!==e.name&&"style"!==e.name&&(t[e.name]=e.value)}),t}return{position:{x:parseFloat(this.wrapperElement.style.left)/100,y:parseFloat(this.wrapperElement.style.top)/100},text:this.text,buttonAttributes:e(this.buttonElement.attributes),popupAttributes:e(this.popupElement.attributes)}}}],[{key:"setElementAttributes",value:function(o,e){var t=1<arguments.length&&void 0!==e?e:{};if(!h.ofType(t,"object")||Array.isArray(t))throw new TypeError(d.getObjectMessage(t));return Object.entries(t).forEach(function(e){var t=(0,s.default)(e,2),n=t[0],r=t[1];if("class"===n&&o.getAttribute(n)){var i="".concat(o.getAttribute(n)," ").concat(r);o.setAttribute(n,i)}else o.setAttribute(n,r)}),o}},{key:"getPositionStyle",value:function(e,t){if(!h.number(e))throw new TypeError(d.getFloatMessage(e));if(!h.number(t))throw new TypeError(d.getFloatMessage(t));return{left:"".concat(100*e,"%"),top:"".concat(100*t,"%")}}},{key:"createFromObject",value:function(e){return new o(e.position,e.text,e.buttonAttributes,e.popupAttributes)}}]),o}(o);g.LABEL_NEW_TAG="New tag",g.LABEL_BUTTON_SAVE="save",g.LABEL_BUTTON_DELETE="delete",t.exports=g},{"../util/event-emitter":21,"../util/object-is":22,"../util/type-error-message":23,"@babel/runtime/helpers/assertThisInitialized":2,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/get":5,"@babel/runtime/helpers/getPrototypeOf":6,"@babel/runtime/helpers/inherits":7,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/possibleConstructorReturn":11,"@babel/runtime/helpers/slicedToArray":13}],19:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/classCallCheck")),o=r(e("@babel/runtime/helpers/createClass")),s=r(e("@babel/runtime/helpers/possibleConstructorReturn")),a=r(e("@babel/runtime/helpers/getPrototypeOf")),u=r(e("@babel/runtime/helpers/get")),l=r(e("@babel/runtime/helpers/inherits")),p=e("offset"),c=e("scrolltop"),f=e("./Tag"),h=e("../util/event-emitter"),d=e("../util/object-is"),g=e("../util/type-error-message"),b=function(e){function r(e){var o,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];if((0,i.default)(this,r),!(e instanceof Element))throw new TypeError(g.getMessage(e,Element));return(o=(0,s.default)(this,(0,a.default)(r).call(this))).wrapper=document.createElement("div"),o.wrapper.classList.add("taggd"),e.classList.add("taggd__image"),e.parentElement.insertBefore(o.wrapper,e),e.parentElement.removeChild(e),o.wrapper.appendChild(e),o.image=e,o.options={},o.tags=[],o.imageClickHandler=function(e){var t=c(),n=p(o.image),r={x:(e.pageX-n.left)/o.image.width,y:(e.pageY-n.top-t)/o.image.height},i=new f(r,f.LABEL_NEW_TAG);i.enableControls(),o.addTag(i)},o.setOptions(t),o.setTags(n),o}return(0,l.default)(r,e),(0,o.default)(r,[{key:"on",value:function(e,t){return(0,u.default)((0,a.default)(r.prototype),"on",this).call(this,e,t)}},{key:"off",value:function(e,t){return(0,u.default)((0,a.default)(r.prototype),"off",this).call(this,e,t)}},{key:"once",value:function(e,t){return(0,u.default)((0,a.default)(r.prototype),"once",this).call(this,e,t)}},{key:"setOptions",value:function(e){if(!d.ofType(e,"object")||Array.isArray(e))throw new TypeError(g.getObjectMessage(e));return this.options=Object.assign(this.options,r.DEFAULT_OPTIONS,e),this}},{key:"addTag",value:function(t){var i=this;if(!d.ofInstance(t,f))throw new TypeError(g.getTagMessage(t));function n(e){return e.target===t.buttonElement}function r(){o&&(window.clearTimeout(o),o=void 0)}var o,e=!this.emit("taggd.tag.add",this,t);return e||(this.options.show===this.options.hide?t.buttonElement.addEventListener(this.options.show,function(e){n(e)&&(r(),t.isHidden()?t.show():t.hide())}):(t.buttonElement.addEventListener(this.options.show,function(e){n(e)&&(r(),t.show())}),t.buttonElement.addEventListener(this.options.hide,function(e){n(e)&&(r(),"mouseleave"===i.options.hide?o=window.setTimeout(function(){return t.hide()},i.options.hideDelay):t.hide())}),"mouseleave"===this.options.hide&&(t.popupElement.addEventListener("mouseover",function(){return r()}),t.popupElement.addEventListener("mouseleave",function(){return t.hide()}))),t.once("taggd.tag.delete",function(){var e=i.tags.indexOf(t);0<=e&&i.deleteTag(e)}),t.onAnything(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.emit.apply(i,[e,i].concat(n))}),this.tags.push(t),this.wrapper.appendChild(t.wrapperElement),this.emit("taggd.tag.added",this,t)),this}},{key:"getTag",value:function(e){if(!Number.isInteger(e))throw new TypeError(g.getIntegerMessage(e));return this.tags[e]}},{key:"deleteTag",value:function(e){if(!Number.isInteger(e))throw new TypeError(g.getIntegerMessage(e));if(!this.tags[e])throw new Error("Tag at index ".concat(e," does not exist."));var t=this.tags[e];return!this.emit("taggd.tag.delete",this,t)||(this.wrapper.removeChild(t.wrapperElement),this.tags.splice(e,1),this.emit("taggd.tag.deleted",this,t)),this}},{key:"setTags",value:function(e){return this.deleteTags(),this.addTags(e),this}},{key:"importTags",value:function(e){var t=this;if(!Array.isArray(e))throw new TypeError(g.getArrayMessage(e,"object"));return e.forEach(function(e){return t.addTag(r.Tag.createFromObject(e))}),this}},{key:"addTags",value:function(e){var t=this;if(!Array.isArray(e))throw new TypeError(g.getArrayMessage(e,"Taggd.Tag"));return e.forEach(function(e){return t.addTag(e)}),this}},{key:"getTags",value:function(){return this.tags}},{key:"deleteTags",value:function(){for(;0<this.tags.length;)this.deleteTag(0);return this}},{key:"map",value:function(e){if(!d.function(e))throw new TypeError(g.getFunctionMessage(e));return this.tags=this.tags.map(e),this}},{key:"destroy",value:function(){return!this.emit("taggd.destroy",this)||this.deleteTags(),this}},{key:"enableEditorMode",value:function(){return!this.emit("taggd.editor.enable",this)||(this.image.addEventListener("click",this.imageClickHandler),this.getTags().forEach(function(e){return e.enableControls()})),this}},{key:"disableEditorMode",value:function(){return!this.emit("taggd.editor.disable",this)||(this.image.removeEventListener("click",this.imageClickHandler),this.getTags().forEach(function(e){return e.disableControls()})),this}}]),r}(h);b.DEFAULT_OPTIONS={show:"mouseenter",hide:"mouseleave",hideDelay:500},t.exports=b,t.exports.Tag=f,window.Taggd=t.exports},{"../util/event-emitter":21,"../util/object-is":22,"../util/type-error-message":23,"./Tag":18,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/get":5,"@babel/runtime/helpers/getPrototypeOf":6,"@babel/runtime/helpers/inherits":7,"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/possibleConstructorReturn":11,offset:16,scrolltop:17}],20:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("./classes/Tag")),o=r(e("./classes/Taggd"));o.default.Tag=i.default,t.exports=o.default},{"./classes/Tag":18,"./classes/Taggd":19,"@babel/runtime/helpers/interopRequireDefault":8}],21:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/classCallCheck")),o=r(e("@babel/runtime/helpers/createClass")),s=function(){function e(){(0,i.default)(this,e),this.handlers={}}return(0,o.default)(e,[{key:"onAnything",value:function(e){this.on("*",e)}},{key:"on",value:function(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)}},{key:"off",value:function(e,t){if(this.handlers[e]){var n=this.handlers[e].indexOf(t);0<=n&&this.handlers[e].splice(n,1)}}},{key:"once",value:function(e,t){var n=this;this.on(e,function(){t.apply(void 0,arguments),n.off(e,t)})}},{key:"emit",value:function(n){for(var e=arguments.length,r=new Array(1<e?e-1:0),t=1;t<e;t++)r[t-1]=arguments[t];var i=!1;return this.handlers["*"]&&this.handlers["*"].forEach(function(e){var t=e.apply(void 0,[n].concat(r));i=void 0!==t&&!t||i}),this.handlers[n]&&this.handlers[n].forEach(function(e){var t=e.apply(void 0,r);i=void 0!==t&&!t||i}),!i}}]),e}();t.exports=s},{"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/interopRequireDefault":8}],22:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/typeof"));t.exports={ofInstance:function(e,t){return e instanceof t},ofType:function(e,t){return(0,r.default)(e)===t},function:function(e){return"function"==typeof e},number:function(e){return!Number.isNaN(Number.parseFloat(e))}}},{"@babel/runtime/helpers/interopRequireDefault":8,"@babel/runtime/helpers/typeof":15}],23:[function(e,t,n){"use strict";var r={getMessage:function(e,t){return"".concat(e," should be ").concat(t)},getArrayMessage:function(e,t){return t?r.getTypeErrorMessage(e,"an array of ".concat(t)):r.getTypeErrorMessage(e,"an array")},getFunctionMessage:function(e){return r.getTypeErrorMessage(e,"a function")},getIntegerMessage:function(e){return r.getTypeErrorMessage(e,"an integer")},getFloatMessage:function(e){return r.getTypeErrorMessage(e,"a floating number")},getObjectMessage:function(e){return r.getTypeErrorMessage(e,"an object")},getTagMessage:function(e){return r.getTypeErrorMessage(e,"a tag")},getTypeErrorMessage:function(e,t){return"".concat(e," is not a ").concat(t)}};t.exports=r},{}]},{},[20])(20)});
//# sourceMappingURL=taggd.min.js.map
